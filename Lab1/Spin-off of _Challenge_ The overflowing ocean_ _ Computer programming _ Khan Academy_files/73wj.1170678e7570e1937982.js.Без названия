(window.webpackJsonp=window.webpackJsonp||[]).push([["73wj"],{"3F4S":function(t,e){window.AceEditor=Backbone.View.extend({dom:{TEXT_INPUT:"textarea",CONTENT:"div.ace_content"},tooltips:{ace_pjs:["imagePicker","soundModal","colorPicker","numberScrubberClick","autoSuggest","numberScrubber"],ace_webpage:["imageModal","colorPicker","numberScrubber"],ace_sql:["numberScrubber"]},initialize:function(t){var e=this;this.defaultCode=t.code,this.autoFocus=t.autoFocus,this.config=t.config,this.record=t.record,this.type=t.type,this.workersDir=t.workersDir,this.editor=ace.edit(this.el),this.textarea=this.$(this.dom.TEXT_INPUT),this.content=this.$(this.dom.CONTENT),this.offset=this.content.offset(),this.record&&this.bindRecord(),this.tooltipEngine=new TooltipEngine({tooltips:this.tooltips[this.type],type:this.type,imagesDir:t.imagesDir,soundsDir:t.soundsDir,editor:this.editor,record:this.record}),this.tooltipEngine.on("scrubbingStarted",function(t){this.trigger("scrubbingStarted",t)}.bind(this)),this.tooltipEngine.on("scrubbingEnded",function(t){this.trigger("scrubbingEnded",t)}.bind(this)),-1!==this.tooltips[this.type].indexOf("autoSuggest")&&ScratchpadAutosuggest.init(this.editor),ace.require("ace/tooltip").Tooltip.prototype.setPosition=function(t,e){var i=$(this.$parentNode).offset();t-=i.left-$(window).scrollLeft(),e-=i.top-$(window).scrollTop(),this.getElement().style.left=t+"px",this.getElement().style.top=e+"px"},this.$el.resizable&&this.$el.resizable({handles:"s",resize:function(){e.editor.resize()}});var i=$("<iframe>").css({width:"100%",height:0,position:"absolute",visibility:"hidden"}).appendTo(this.el);$(i[0].contentWindow.window).on("resize",function(){this.editor.resize(),this.editor.setFontSize(this.$el.width()<400?"12px":"14px")}.bind(this)),this.$el.on("mousedown",".tooltip",(function(t){t.preventDefault()})),this.editor.commands.removeCommand("gotoline"),this.editor.commands.bindKey("Alt-0",null),this.editor.selection.addEventListener("changeCursor",(function(){e.setErrorHighlight(!1)})),this.editor.on("change",function(){e.trigger("change"),this.editor.curOp&&this.editor.curOp.command.name&&e.trigger("userChangedCode")}.bind(this)),this.editor.on("click",(function(){e.trigger("click")})),this.editor.selection.on("changeCursor",(function(){e.trigger("changeCursor")})),this.editor.selection.on("changeSelection",(function(){e.trigger("changeCursor")})),this.config.on("versionSwitched",(function(t){e.config.runVersion(t,e.type+"_editor",e)})),this.config.editor=this,this.reset()},remove:function(){this.tooltipEngine.remove()},bindRecord:function(){var t=this,e=this.editor,i=this.record,o=e.session.doc;o.on("change",(function(e){var i=e.data.range.start,o=e.data.range.end;if(0===e.data.action.indexOf("insert")){var n=e.data.lines||e.data.text;t.record.log(e.data.action,i.row,i.column,o.row,o.column,n)}else t.record.log(e.data.action,i.row,i.column,o.row,o.column)}),!0),e.selection.addEventListener("changeCursor",(function(){e.selection.isEmpty()&&t.handleSelect()}),!0),e.selection.addEventListener("changeSelection",this.handleSelect.bind(this),!0);_.each(["insertText","insertLines","removeText","removeLines"],(function(t){i.handlers[t]=function(e,i,n,r,s){var c={action:t,range:{start:{row:e,column:i},end:{row:n,column:r}}};"insertText"===t?c.text=s:"insertLines"===t&&(c.lines=s),o.applyDeltas([c])}})),$.extend(i.handlers,{select:function(t,i,o,n){null==o&&(o=t),null==n&&(n=i),e.selection.setSelectionRange({start:{row:t,column:i},end:{row:o,column:n}})}}),i.seekCachers.editor={getState:function(){return{text:t.text(),cursor:t.getCursor()}},restoreState:function(e){t.text(e.text),t.setCursor(e.cursor)}},i.on("runSeek",(function(){t.reset(i.initData.code)}))},handleSelect:function(){if(this.record.recording){var t=this.editor.selection.getRange(),e=t.start,i=t.end;this.record.log("select",e.row,e.column,i.row,i.column)}},reset:function(t,e){t=t||this.defaultCode,this.config.runCurVersion(this.type+"_editor",this),this.text(t),this.setCursor({row:0,column:0},e)},setErrorHighlight:function(t){this.editor.setHighlightActiveLine(t)},toggleGutter:function(t){this.editor.renderer.setShowGutter(t)},getAllFolds:function(){var t=this.editor.session;return _.map(t.getAllFolds(),(function(t){return[t.start.row,t.end.row]}))},setFolds:function(t){_.each(t,function(t){this.editor.session.foldAll(t[0],t[1],0)}.bind(this))},blockPaste:function(t){var e=this.editor;e.originalCut||(e.originalCut=e.onCut,e.originalCopy=e.onCopy,e.originalPaste=e.onPaste),e.onCut=function(t){e.lastCopied=this.getSelectedText(),e.originalCut.apply(e)},e.onCopy=function(t){e.lastCopied=this.getSelectedText(),e.originalCopy.apply(e)},e.onPaste=function(i){i===e.lastCopied||i.length<3||i.match(/\s*https?:\/\/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)\s*/)?e.originalPaste.apply(e,[i]):t()};var i=!1;e.container.addEventListener("dragstart",(function(){i=!0})),e.container.addEventListener("dragend",(function(){i=!1})),e.container.addEventListener("drop",(function(e){i||(t(),e.stopPropagation())}),!0)},focus:function(){!1!==this.autoFocus&&this.editor.focus()},getCursor:function(){return this.editor.getCursorPosition()},getSelectionIndices:function(){var t=this.editor.getSelectionRange(),e=this.editor.getSession().getDocument();return{start:e.positionToIndex(t.start),end:e.positionToIndex(t.end)}},setCursor:function(t,e){this.editor.moveCursorToPosition(t),this.editor.clearSelection(),!1!==e&&!1!==this.autoFocus&&this.editor.focus()},setSelection:function(t){this.editor.selection.setSelectionRange(t)},setReadOnly:function(t){this.editor.setReadOnly(t)},text:function(t){return null==t?this.editor.getSession().getValue().replace(/\r\n/g,"\n"):(this.editor.getSession().setValue(t),this)},unfold:function(){return this.editor.getSession().unfold()},insertNewlineIfCursorAtEnd:function(){var t=this.editor.getSession().getLength()-1,e=this.editor.getSession().getLine(t).length,i=this.editor.getCursorPosition();if(i.row===t&&i.column===e){var o=this.text();o.length&&"\n"!==o[o.length-1]&&(this.text(this.text()+"\n"),this.setCursor({row:t+1,column:0}))}},undo:function(){this.editor.undo()}}),LiveEditor.registerEditor("ace_pjs",AceEditor),LiveEditor.registerEditor("ace_webpage",AceEditor),LiveEditor.registerEditor("ace_sql",AceEditor)}}]);
//# sourceMappingURL=../../sourcemaps/en/73wj.1170678e7570e1937982.js.map